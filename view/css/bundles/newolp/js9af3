function getFilters(){var n=api+apiName+gameSeoName+"/"+currency+"?DisplayFileds=Categorys";$.ajax({url:n,type:"GET",dataType:"json",success:function(n){initSelectFilters(n.Result);$("#filters .offer-search-reset").eq(0).addClass("loaded").html("<i><\/i><span>Reset<\/span>");$(".offer-search-count").show()},error:function(n){console.log(n)}})}function initSelectFilters(n){var e=n.Categorys,t=e[0]||[],f,o,r,i,u;if(allServers=t,f=e[1]||[],o=0,displayFileds.servers=t,displayFileds.quantity=f,(t.length===1&&t[0].SubCategorys.length===0||t[0].SubCategorys.length===1)&&(isServerOnlyOne=!0),$(".filter-servers").append("<option value='' selected disabled hidden >"+metaServer+"<\/option>"),$.each(t,function(n,i){o=t[0].Id;$(".filter-servers").append("<option  value="+i.Id+">"+i.Name.LangCode.en+"<\/option>")}),newServerId&&$(".filter-servers").find("option[value="+newServerId+"]").length||$(".filter-p-servers").find("option[value="+newServerId+"]").length)$(".filter-servers").find("option[value="+newServerId+"]").prop("selected",!0),$(".filter-sub-servers").append(serversSearch(allServers,newServerId));else if(newServerId){for(r=null,i=0;i<allServers.length;i++)if(allServers[i].SubCategorys.length)for(u=0;u<allServers[i].SubCategorys.length;u++)if(allServers[i].SubCategorys[u].Id===newServerId){r=allServers[i].Id;break}$(".filter-sub-servers").append(serversSearch(allServers,r));$(".filter-servers").find("option[value="+r+"]").prop("selected",!0);$(".filter-servers-second").find("option[value="+newServerId+"]").prop("selected",!0)}$.each(f,function(n,t){jsquantity=GetQueryString("Quantity")||t.Default;$(".filter-quantity").append("<option  value="+t.Id+">&nbsp"+t.Name.LangCode.en+"&nbsp&nbsp&nbsp&nbsp<\/option>");$(".filter-quantity").find("option[value="+jsquantity+"]").prop("selected",!0)});initFilters()}function setFirstLevelClass(){$(".mask-dropdown-wrap-js ul:first-child").children("li").children("label").addClass("dropdown-heading")}function serversSearch(n,t){var i="";return $.each(n,function(n,r){t==r.Id&&r.SubCategorys&&r.SubCategorys.length>0?(i+="<select id='filter-servers-second' class='select filter-servers select-outer-default-xs'><option value='' selected disabled hidden >"+metaFaction+"<\/option>",$.each(r.SubCategorys,function(n,t){i+="<option value='"+t.Id+"'>"+t.Name.LangCode.en+"<\/option>"}),i+="<\/select><label for='filter-servers-second' aria-label='Select Sub Server'><\/label>"):i==""&&r.SubCategorys&&r.SubCategorys.length>=0&&(i+=serversSearch(r.SubCategorys,t))}),i}function goBtn(n){var i="",r=$(".filter-quantity-first").find("option:selected"),t;t=n?$(".filter-servers-second").find("option:selected"):$(".filter-servers-first").find("option:selected");i+=$(t).text()+" - "+$(r).text();filters.FilterParams.Serverid=$(t).val();$.cookie("selectedServer",i);filters.Pager.PageIndex=1;window.location=queryConfig(filters)}function goBtnMob(){filters.Pager.PageIndex=1;displayFileds.isQty?(filters.FilterParams.Quantity=displayFileds.selected||"",$.cookie("selectedQty",displayFileds.selectedTitle)):(filters.FilterParams.Serverid=displayFileds.selected||"",$.cookie("selectedServers",displayFileds.selectedTitle));window.location=queryConfig(filters)}function initFilters(){var s="",f=GetQueryString("SortField"),o,n,i,r,u;if(f&&(s+=f,filters.FilterParams.SortField=f),o=GetQueryString("sPid"),o){if($(".filter-sub-servers").empty(),n=$(".filter-servers").val(),servers=serversSearch(allServers,n),n==0||!servers||servers.length<1)return;$(".filter-sub-servers").append(servers);$(".filter-sub-servers select").change(function(){$(this).siblings().remove();n=$(this).val();servers=serversSearch(allServers,n);(n==0||!servers||servers.length<1)&&goBtn.call($(".btn-go"),!0);$(".filter-sub-servers").append(servers)})}let t="";if(i=$("#filter-servers option:selected"),r=$("#filter-servers-second option:selected"),$(r).text()){let n=$(r).val();t=n!==""?$(i).text()+"-"+$(r).text():$(i).text()}else t=$(i).text();let h=$(".search-servers .placeholder-text-js"),e=$(".search-qty .placeholder-text-js");if($(h).html(t),displayFileds.params.FilterParams.Quantity){let n=$.cookie("selectedQty");n?$(e).html(n):$(e).html(displayFileds.placeholder.qty)}else u=$(".filter-quantity option:selected"),$.cookie("selectedQty",$(u).text()),displayFileds.params.FilterParams.Quantity=$(u).val(),$(e).html($(u).text());OLPLoading=!1;$("#filters .offer-search-reset").eq(0).addClass("loaded").html("<i><\/i><span>Reset<\/span>");$(".offer-search-count").show()}function handleDropdown(){function t(n,t){displayFileds.selected=t;displayFileds.selectedTitle=n;n.length>0?i.html(`Select ${n}`):i.html(r?displayFileds.placeholder.qty:displayFileds.placeholder.servers)}let i=$(".mask-dropdown-wrap-js .placeholder-text-js"),u=$(".mask-dropdown-close"),f=$("#btn-confirm"),r=displayFileds.isQty,n=$(".mask-dropdown-wrap-js ul").children("li");$(".dropdown-heading").click(function(){var i=$(this).find(" + .menu-items");if($(this).toggleClass("active"),$(i).slideToggle(),$(".menu-items").not(i).slideUp(),$(".dropdown-heading").not(this).removeClass("active"),$(n).removeClass("active"),$(this).hasClass("active")){let i=$(this).next().length>0,u=$(this).parent("li").val(),n=$(this).text();t(!r&&i?`All ${n}`:n,u)}else t("","");$(i).delegate("li:not(.active)","click",function(){$(n).removeClass("active");$(this).addClass("active");let i=$(this).parent("ul.menu-items").prev().text(),r=$(this).text();t(`${i} - ${r}`,this.getAttribute("value"))})});$(n).delegate("li:not(.active)","click",function(){let i=this.parentElement;i&&$(i).prev("label.dropdown-heading").addClass("active");n.removeClass("active");$(this).addClass("active");let r=$(i).prev().text(),u=$(this).text();t(`${r} - ${u}`,this.getAttribute("value"))});$(f).click(function(){if(displayFileds.selected===""){closeDropdown();return}goBtnMob.call($(".btn-go"))});$(u).click(function(){closeDropdown()})}function closeDropdown(){var n=document.getElementById("target");let t=$(".mask-dropdown-wrap-js"),i=$(".mask-dropdown-wrap-js .placeholder-text-js");$(t).hide();n.innerHTML="";i.innerHTML="";$("body").removeClass("overflow-hide");$(".bg-mask").hide()}function renderDropdownList(n){var r=document.createElement("ul"),t,i;for(val of n)t=document.createElement("li"),t.setAttribute("value",val.Id),i=document.createElement("label"),i.innerHTML=val.Name.LangCode.en,t.appendChild(i),val.SubCategorys&&val.SubCategorys.length>0&&(t.appendChild(renderDropdownList(val.SubCategorys)),t.firstChild.className="dropdown-heading has-child",t.querySelector("ul").className="menu-items"),r.appendChild(t);return r}function setDisplayFiledsSelected(){displayFileds.selectedTitle="";let i=$(".dropdown-list-wrap ul").children("li"),n=$(".mask-dropdown-wrap-js .placeholder-text-js");for(var t=0;t<i.length;t++){let n=i[t],r=n.getAttribute("value");if(r===displayFileds.params.FilterParams.Serverid||r===displayFileds.params.FilterParams.Quantity){let t=n.parentElement,i=$(n).children(".menu-items");if(t){let n=$(t).prev("label.dropdown-heading");$(n).addClass("active");$(t).slideDown()}i&&($(i).slideDown(),$(n).children("label.dropdown-heading").addClass("active"));$(n).addClass("active")}}if(displayFileds.isQty){if(displayFileds.params.FilterParams.Quantity===""){n.html(displayFileds.placeholder.qty);return}n.html("Select "+$.cookie("selectedQty"))}if(!displayFileds.isQty){if(displayFileds.params.FilterParams.Serverid===0){n.html(displayFileds.placeholder.servers);return}n.html("Select "+$.cookie("selectedServers"))}}var apiName="api/game/",width=$(document).width(),featured=[],offerListBox=$("#offerListBox"),sPid=0,isServerOnlyOne=!1,newServerId;OLPLoading=!0;$.fn.digits=function(){return this.each(function(){$(this).text($(this).text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))})};newServerId=null;newServerId=myGetQueryString("Serverid",!0)||0;newServerId=Number(newServerId)?newServerId:0;sPid=myGetQueryString("sPid",!0)||0;var jsquantity="",sort="",filters={IsFeatured:0,Pager:_filters.Pager,FilterParams:{v:GetQueryString("v")||"",SortField:GetQueryString("SortField")||"",keyword:"",Serverid:newServerId,Quantity:GetQueryString("Quantity")||"",Itemid:"",seller:GetQueryString("seller")||""}},allServers=[],categorys=[],displayFileds={servers:[],quantity:[],isQty:!1,params:filters,selected:"",selectedTitle:"",placeholder:{qty:"Quantity",servers:"Server and Faction"}};$(".filter-servers-pc").change(function(){goBtn.call($(".btn-go"),!1)});$(".filter-sub-servers-pc").change(function(){goBtn.call($(".btn-go"),!0)});$(".dropdown-wrap-js.search-servers, .dropdown-wrap-js.search-qty").click(function(){var n=document.getElementById("target");let t="";$(n).html("");displayFileds.isQty=$(this).hasClass("search-qty");t=displayFileds.isQty?renderDropdownList(displayFileds.quantity):renderDropdownList(displayFileds.servers);n.appendChild(t);setFirstLevelClass();$(".mask-dropdown-wrap-js").show();$(".bg-mask").show();$("body").addClass("overflow-hide");setDisplayFiledsSelected();handleDropdown()});$(".filter-quantity").change(function(){filters.FilterParams.Quantity=$(this).val();$(".filter-servers-second").find("option:selected").val()?goBtn.call($(".btn-go"),!0):goBtn.call($(".btn-go"),!1);$.cookie("selectedQty",$(this).children("option:selected").text());$.cookie("quantity",$(this).children("option:selected").text().split(" : ")[1])});$(function(){getFilters();$(".bg-mask").click(function(){closeDropdown()})})